<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Camera to Thai & English Translator</title>
  <style>
    video, canvas { border: 1px solid black; margin: 10px; }
    #result { white-space: pre-wrap; margin-top: 20px; }
    button { padding: 10px 20px; margin: 10px; font-size: 16px; }
  </style>
</head>
<body>

<h2>ğŸ“¸ Take Picture â¤ ğŸ§  OCR â¤ ğŸŒ Translate</h2>

<video id="video" width="320" height="240" autoplay></video><br>
<button onclick="capture()">ğŸ“¸ Capture</button>
<canvas id="canvas" width="320" height="240"></canvas><br>
<button onclick="extractText()">ğŸ§  OCR & Translate</button>

<div id="result"><strong>Result:</strong></div>

<!-- Tesseract.js -->
<script src="https://cdn.jsdelivr.net/npm/tesseract.js@4.0.2/dist/tesseract.min.js"></script>

<script>
navigator.mediaDevices.getUserMedia({ video: true })
  .then(stream => {
    document.getElementById('video').srcObject = stream;
  });

function capture() {
  const video = document.getElementById('video');
  const canvas = document.getElementById('canvas');
  canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);
}

async function extractText() {
  const canvas = document.getElementById('canvas');
  document.getElementById('result').innerText = "ğŸ” Extracting text...";
  
  const result = await Tesseract.recognize(
    canvas,
    'eng+tha',
    { logger: m => console.log(m) }
  );

  const detected = result.data.text.trim();
  document.getElementById('result').innerText = "ğŸ“ Detected Text:\n" + detected + "\n\nğŸŒ Translating...";

  const en = await translateText(detected, 'en');
  const th = await translateText(detected, 'th');

  document.getElementById('result').innerText = `ğŸ“ Detected Text:\n${detected}\n\nğŸ‡¬ğŸ‡§ English:\n${en}\n\nğŸ‡¹ğŸ‡­ Thai:\n${th}`;
}

async function translateText(text, targetLang) {
  const res = await fetch('https://libretranslate.de/translate', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      q: text,
      source: 'auto',
      target: targetLang,
      format: 'text'
    })
  });

  const data = await res.json();
  return data.translatedText;
}
</script>

</body>
</html>
